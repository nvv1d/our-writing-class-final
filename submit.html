<!DOCTYPE html>
<html style="font-size: 16px;" lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="utf-8">
  <title>Submit Your Assignment</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss/dist/tailwind.min.css">
  <!-- React and dependencies -->
  <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <style>
    body {
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      background-color: rgba(247, 247, 247, 0.8);
    }

    img {
      pointer-events: none;
      -webkit-user-drag: none;
      user-drag: none;
    }

    p, h1, h2, h3, h4, h5, h6 {
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 2rem;
      background-color: #ffffff;
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      position: relative;
    }

    .home-button {
      position: absolute;
      top: 1rem;
      left: 2rem;
      background-color: #e3b377;
      color: white;
      padding: 8px 16px;
      border-radius: 5px;
      text-decoration: none;
      transition: background-color 0.3s ease;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .home-button:hover {
      background-color: #d6a462;
    }

    .title {
      font-size: 2rem;
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 1.5rem;
      padding-top: 2rem;
    }

    .description {
      text-align: justify;
      line-height: 1.6;
      margin-bottom: 2rem;
      color: #333;
      letter-spacing: 0.2px;
    }

    .topic {
      background-color: rgba(227, 179, 119, 0.2);
      border-radius: 0.5rem;
      padding: 1rem;
      margin-bottom: 1.5rem;
    }

    .topic-title {
      font-size: 1.25rem;
      font-weight: 500;
      color: #e3b377;
      margin-bottom: 0.5rem;
    }

    .text-area {
      width: 100%;
      height: 400px;
      padding: 1rem;
      border: 1px solid #ccc;
      border-radius: 0.5rem;
      font-size: 1rem;
      font-family: inherit;
      resize: none;
      outline: none;
      transition: border-color 0.3s ease;
      background-color: rgba(255, 255, 255, 0.8);
    }

    .text-area::placeholder {
      color: #ccc;
      font-style: italic;
    }

    .text-area:focus {
      border-color: #e3b377;
    }

    .submit-button {
      background-color: #e3b377;
      color: white;
      padding: 12px 24px;
      border-radius: 5px;
      text-decoration: none;
      transition: background-color 0.3s ease;
      display: inline-block;
      margin-top: 1.5rem;
      border: none;
      cursor: pointer;
    }

    .submit-button:hover {
      background-color: #d6a462;
    }

    .submit-message {
      font-size: 1.25rem;
      font-weight: 500;
      color: #2c3e50;
      display: inline-block;
      margin-left: 1rem;
    }

    .dropdown {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #ccc;
      border-radius: 0.5rem;
      font-size: 1rem;
      font-family: inherit;
      background-color: rgba(255, 255, 255, 0.8);
      margin-bottom: 1rem;
      transition: border-color 0.3s ease;
      color: #2c3e50;
    }

    .dropdown:focus {
      border-color: #e3b377;
      outline: none;
    }

    .dropdown-label {
      font-weight: 500;
      color: #2c3e50;
      margin-bottom: 0.25rem;
      display: block;
    }
  </style>
  <script>
    // Disable right-click context menu
    document.addEventListener('contextmenu', function(e) {
      e.preventDefault();
    }, false);

    // Disable Ctrl+U to prevent "view page source"
    document.addEventListener('keydown', function(e) {
      if (e.ctrlKey && e.key === 'u') {
        e.preventDefault();
      }
    });

    // Disable Ctrl+Shift+I, F12 to prevent "inspect element"
    document.addEventListener('keydown', function(e) {
      if ((e.ctrlKey && e.shiftKey && e.key === 'I') || e.key === 'F12') {
        e.preventDefault();
      }
    });
  </script>
</head>
<body>
  <div class="container">
    <a href="https://our-writing-class.vercel.app/" class="home-button">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
        <polyline points="9 22 9 12 15 12 15 22"></polyline>
      </svg>
      Home
    </a>
    <h1 class="title">Submit Your Assignment ‚úçüèª</h1>
    <p class="description">
      Howdy, writer! Welcome to the assignment submission page. This is your chance to shine and share your narrative writing with the class. I'm so excited to read your work and provide feedback. Just pour your heart into the text area below, and hit that submit button when you're ready. Let's do this!
    </p>
    <!-- Class and Name dropdowns -->
    <label class="dropdown-label" for="class-dropdown">Class:</label>
    <select id="class-dropdown" class="dropdown">
      <option value="TEFL 402">TEFL 402</option>
    </select>

    <label class="dropdown-label" for="name-dropdown">Name:</label>
    <select id="name-dropdown" class="dropdown">
      <option value="" disabled selected>Select your name</option>
      <option>Dr. Behzadpoor</option>
      <option>Ali Tahavvory</option>
      <option>AmirAli Hashemi</option>
      <option>Asra Bakhtar</option>
      <option>Ata Aghamali</option>
      <option>Farzane Hamdi</option>
      <option>Leyla Ne'mati</option>
      <option>Maryam Germchi</option>
      <option>Nahid Mohammadi</option>
      <option>Sana Ja'farkhani</option>
      <option>Sahar Seraj</option>
      <option>Tohid Sabbagh</option>
      <option>Zahra Sa'adatKhah</option>
      <option>Zahra ---</option>
    </select>

    <div class="topic">
      <h2 class="topic-title">Topic: ---</h2>
      <p>Craft your narrative based on the topic above.</p>
    </div>
    <textarea class="text-area" placeholder="Firstly, introduce your main character and the setting...

Next, describe the conflict or challenge they are facing...

Then, explain how the character tries to overcome the obstacle...

Finally, conclude by sharing the resolution or lesson learned."></textarea>

    <!-- React root div -->
    <div id="submit-button-root"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/confetti-js@0.0.18/dist/index.min.js"></script>

<!-- React component with fixed validation -->
<script type="text/babel">
  const TelegramIntegration = () => {
    const [submittedText, setSubmittedText] = React.useState('');
    const [isSubmitting, setIsSubmitting] = React.useState(false);
    const [submissionStatus, setSubmissionStatus] = React.useState(null);

    const handleSubmit = async () => {
      const textareaValue = document.querySelector('.text-area').value.trim();
      const nameDropdown = document.getElementById('name-dropdown').value;
      const classDropdown = document.getElementById('class-dropdown').value;

      // Clear previous status before new submission attempt
      setSubmissionStatus(null);

      // Validation checks
      if (!textareaValue) {
        setSubmissionStatus("empty");
        return;
      }
      if (!nameDropdown) {
        setSubmissionStatus("nameEmpty");
        return;
      }

      setIsSubmitting(true);

      try {
        const response = await axios.post('/api/submitAssignment', {
          message: `Class: ${classDropdown}\nName: ${nameDropdown}\n\n${textareaValue}`,
        });

        if (response.data.success) {
          setSubmittedText(textareaValue);
          setSubmissionStatus("success");

          // Trigger confetti effect
          const confettiSettings = { target: 'confetti-canvas' };
          const confetti = new ConfettiGenerator(confettiSettings);
          confetti.render();
          setTimeout(() => confetti.clear(), 3000);
        } else {
          setSubmissionStatus("error");
        }
      } catch (error) {
        console.error('Error:', error);
        setSubmissionStatus("error");
      } finally {
        setIsSubmitting(false);
      }
    };

    return (
      <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>
        <button
          className="submit-button"
          onClick={handleSubmit}
          disabled={isSubmitting}
          style={{ opacity: isSubmitting ? 0.7 : 1 }}
        >
          {isSubmitting ? 'Submitting...' : 'Submit Assignment'}
        </button>
        {submissionStatus && (
          <span style={{
            color: submissionStatus === "success" ? "#4CAF50" : "#f44336",
            fontWeight: '600',
            fontSize: '16px'
          }}>
            {submissionStatus === "success" ? "Submitted Successfully!" :
             submissionStatus === "nameEmpty" ? "Please select your name!" :
             submissionStatus === "empty" ? "Please write something before submitting!" :
             "An error occurred while submitting."}
          </span>
        )}
      </div>
    );
  };

  // Render the React component
  ReactDOM.render(
    <TelegramIntegration />,
    document.getElementById('submit-button-root')
  );
</script>
<canvas id="confetti-canvas" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9999;"></canvas>
</body>
</html>
